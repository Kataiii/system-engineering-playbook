[Ссылка на публикацию](https://vc.ru/life/2643115-sozdanie-ii-trenera-arhitektura-mobilnogo-prilozheniya)

# Как мы строим ИИ-тренера: архитектура мобильного приложения для адаптивных тренировок на базе ML

Каждый, кто хотя бы раз пытался тренироваться по программе из интернета или по шаблону из приложения, сталкивался с проблемой: план не учитывает вашу усталость после работы, стресс, плохой сон или индивидуальные особенности техники. Результат — отсутствие прогресса, выгорание или травма. Мы решили эту проблему, создав не просто дневник тренировок, а интеллектуального персонального тренера в вашем смартфоне.

Рассказываем, как устроено ядро нашего приложения — система, которая видит, анализирует, учится и принимает решения.

## Не данные, а «цифровой двойник»: Мультимодальный сбор информации

Основа нашего ИИ — не один датчик, а слияние нескольких потоков данных. Это позволяет создать «цифрового двойника» пользователя в реальном времени.

Компьютерное зрение (CV) — глаза тренера.Используем камеру смартфона для анализа техники. Через библиотеки вроде MediaPipe Pose система в режиме реального времени определяет 33 ключевые точки скелета. Это не просто «счётчик повторений». Мы вычисляем:
Углы в суставах (например, сгиб колена в приседе).Траектории движения (симметричность подъёма гантелей).Опасные паттерны (округление спины в тяге).Для классификации упражнений и выявления ошибок «под капотом» работает свёрточная нейронная сеть (CNN), обученная на тысячах примеров правильной и неправильной техники.
Носимые устройства (IoT) — внутренние датчики.Интеграция с фитнес-браслетами и часами даёт непрерывный поток физиологии:
ЧСС и вариабельность сердечного ритма (HRV) — ключевые маркеры восстановления и стресса.Сон и SpO2 (уровень кислорода в крови).Эти данные формируют многомерные временные ряды — основу для прогнозирования состояния.
Субъективный ввод — учёт психологии.Раз в день приложение коротко спрашивает: «Как самочувствие?», «Оцените сон и стресс по шкале от 1 до 10». Эти субъективные метрики критически важны для корректировки плана, так как напрямую влияют на мотивацию и риск перетренированности.

## Аналитическое ядро: гибрид ML-моделей, где каждая решает свою задачу

Собранные данные попадают в аналитический блок. Мы отказались от идеи одной «универсальной» модели ИИ в пользу гибридного подхода, где каждый метод используется для решения специфической задачи с максимальной эффективностью.

Модуль безопасности: XGBoost/LightGBM.Для работы с табличными данными (возраст, вес, история тренировок и травм, статические ошибки техники) лучше всего подходят ансамбли деревьев решений. Мы используем градиентный бустинг (XGBoost).Что делает: На основе сотен параметров модель в реальном времени вычисляет вероятность риска травмы (от 0 до 1) для конкретного упражнения и пользователя. Она устойчива к шумам в данных и выдаёт не только ответ, но и интерпретируемые причины (например, «риск повышен из-за ошибки в технике и низкого показателя восстановления»).
Модуль состояния: рекуррентные сети (LSTM).Физиологические данные с часов — это временные ряды с долгосрочными зависимостями (как сегодняшняя усталость зависит от нагрузки три дня назад). Для их анализа идеально подходят LSTM-сети.Что делает: Модель анализирует динамику ЧСС и HRV за последние 3-7 дней и предсказывает:
Уровень утомления на сегодня.Риск состояния перетренированности (как задача бинарной классификации).Теоретическую готовность к нагрузке (прогноз 1ПМ).
Модуль стратегии: обучение с подкреплением (Reinforcement Learning).Это самая сложная и инновационная часть системы — мозг тренера. Мы рассматриваем процесс тренировок как взаимодействие агента (нашей системы) со средой (пользователем).
Состояние (State): Вектор из всех собранных данных (метрики CV, физиология, субъективные оценки, история).Действие (Action): Коррекция плана: изменить вес, количество повторов, выбрать другое упражнение, увеличить отдых.Вознаграждение (Reward): Скаляр, который увеличивается за прогресс (рост силы, улучшение техники) и уменьшается за негативные исходы (риск травмы, признаки перетренированности, отсутствие прогресса).
RL-агент методом проб и ошибок учится строить долгосрочную стратегию, которая максимизирует совокупное вознаграждение. Он не просто следует жёстким правилам («если устал — снизи вес»), а находит нетривиальные, но эффективные для конкретного человека пути к цели.

## Принятие решений: что видит пользователь?

Всё это сливается в простые и конкретные рекомендации в реальном времени:

Коррекция техники: «Во время приседа заметен наклон корпуса вперёд. Рекомендуем снизить вес на 10% и сфокусироваться на сохранении спины прямой. Вот ваше текущее и целевое положение (скриншот с наложением скелета)».
Адаптация нагрузки: «Ваш показатель восстановления (HRV) сегодня на 20% ниже среднего. Запланированную интенсивную тренировку заменяем на лёгкое восстановительное кардио 25 минут».
Упреждающее управление рисками: «Вероятность нагрузки на поясницу высокая. Исключите становую тягу сегодня, заменив её на гиперэкстензию и тягу в наклоне».

## Технические вызовы и почему это сложно

Создание такой системы — это не только ML, но и инженерные задачи:

Производительность на мобильном устройстве: Модели CV (MediaPipe) и лёгкие версии ML-моделей (например, TFLite) должны работать в фоне, не сажая батарею за час.
Конвейер данных: Непрерывный поток и синхронизация разнородных данных с разных источников (камера, Bluetooth-датчики, ручной ввод) с минимальной задержкой.
Приватность: Ключевая философия — обработка максимального количества данных на устройстве (on-device), без отправки чувствительной биометрики в облако. Только агрегированные анонимные метрики могут использоваться для дообучения моделей.
Обучение RL-агента: Это длительный и ресурсоёмкий процесс, требующий симуляций. Мы используем симулятор на исторических анонимных данных, чтобы предобучить агента перед его «выпуском» к реальным пользователям.

## Что в итоге?

Мы строим не очередной трекер, а экосистему адаптивного тренировочного процесса. Гибрид ML-подхода (XGBoost + LSTM + RL + CV) позволяет создать по-настоящему персонального, безопасного и эффективного цифрового тренера.

Такой ИИ не заменит живого специалиста в профессиональном спорте, но сделает качественный, основанный на данных фитнес доступным для миллионов людей, помогая тренироваться умнее, избегать травм и сохранять мотивацию.

Спасибо за внимание! Интересуют ли вам технические детали реализации какого-то из модулей? Готовы рассказать больше в следующих статьях.
